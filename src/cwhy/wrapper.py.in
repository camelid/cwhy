#! /usr/bin/env python3

import os
import subprocess
import sys

from cwhy import cwhy

process = subprocess.run(
    ["{compiler}", *sys.argv[1:]],
    stdout=subprocess.PIPE,
    stderr=subprocess.STDOUT,
    text=True,
)
status = process.returncode
if "CWHY_DISABLE" not in os.environ and status != 0:
    print(process.stdout)
    print("==================================================")
    print("CWhy")
    print("==================================================")
    cwhy.evaluate({args}, process.stdout)
    print("==================================================")
sys.exit(status)
